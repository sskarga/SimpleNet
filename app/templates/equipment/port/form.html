{% from "macros.html" import make_form with context %}
{% extends "layout.html" %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
    <div class="card">
        <div class="card-header">
            <h4>{{ title }}</h4>
        </div>
        <div class="card-body">

            <form action="" method="post">
                {{ make_form(form, style='rows') }}
            </form>

        </div>
    </div>
{% endblock %}

{% block footerJS %}
    {{ super() }}

    <script src="{{ url_for('static', filename='vendor/jquery.inputmask.min.js') }}"></script>
    <script>
        $('#ipv4').inputmask('ip');

        $('#cvlan').inputmask("integer", {
            min: '1',
            max: "3999",
            rightAlign: false
        })

        function radiusFields() {
            $('#radius_user').val($('#svlan').val() + '.' + $('#cvlan').val());
            $('#radius_pass').val($('#svlan').val() + '.' + $('#cvlan').val());
        };

        function get_cvlan() {
            let vlanStart = parseInt($("#eqptcvlan").val(), 10);
            let portNumber = parseInt($("#port").val(), 10) - 1;
            $("#cvlan").val(vlanStart + portNumber);
        };

        get_cvlan();
        radiusFields();

        $("#port").change(function () {
            get_cvlan();
            radiusFields();
        });

        $("#cvlan").change(function () {
            radiusFields();
        });

    </script>

{% endblock %}